<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>二手书集市 - 书籍详情</title>
    <link rel="stylesheet" href="assets/styles.css" />
</head>
<body>
    <header class="site-header">
        <div class="container header-inner">
            <a class="brand" href="index.html">二手书集市</a>
            <nav class="nav">
                <a href="index.html">首页</a>
                <a href="sell.html">发布</a>
                <a href="favorites.html">收藏</a>
            </nav>
        </div>
    </header>

    <main class="container">
        <div id="content" class="detail"></div>
    </main>

    <footer class="site-footer">© <span id="year"></span> 二手书集市</footer>

    <script src="assets/data.js"></script>
    <script src="assets/app.js"></script>
    <script>
		document.getElementById('year').textContent = new Date().getFullYear();
		const params = new URLSearchParams(location.search);
		const id = params.get('id');
		const book = sampleBooks.find(b => b.id === id);

		const content = document.getElementById('content');
		if (!book) {
			content.innerHTML = '<div class="card">该书籍不存在或已下架。<div class="spacer"></div><a class="link" href="index.html">返回首页</a></div>';
		} else {
			content.innerHTML = `
				<div class="detail-grid">
					<div class="detail-cover card"><img alt="${escapeHtml(book.title)}" src="${book.cover}" /></div>
					<div class="detail-info">
						<h1>${escapeHtml(book.title)}</h1>
						<p class="muted">作者：${escapeHtml(book.author)}</p>
						<div class="pill-row">
							<span class="price">¥${book.price.toFixed(0)}</span>
							<span class="pill">${book.condition}</span>
							<span class="muted">${escapeHtml(book.campus)}</span>
						</div>
						<p class="desc">${escapeHtml(book.description || '无描述信息')}</p>
						<div class="actions">
							<button class="btn" id="favBtn">收藏</button>
							<button class="btn primary" id="contactBtn">联系卖家</button>
						</div>
					</div>
				</div>
			`;
			const favBtn = document.getElementById('favBtn');
			updateFavoriteButton(favBtn, isFavorited(book.id));
			favBtn.addEventListener('click', () => {
				toggleFavorite(book.id);
				updateFavoriteButton(favBtn, isFavorited(book.id));
			});
			document.getElementById('contactBtn').addEventListener('click', () => {
				alert('联系卖家功能即将上线');
			});
		}
    </script>
</body>
</html>